;;-*- mode: nendo; syntax: scheme -*-;;
;; test for sekka jisyo library

(use nendo.test)
(load "./lib/convert-jisyo.nnd")

(test-start "jisyo converter")

;;===================================================================
;;-------------------------------------------------------------------
(test-section "SKK2Sekka")

(let1 hira-list
    (map
     (lambda (x)
       (second x))
     sekka-kana->roman-table)
  (test* "kana->roman table length"        232 (length hira-list))
  (test* "kana->roman key duplicate check" 232 (length (uniq (sort hira-list)))))

(test* "hiragana -> roman-pattern1"
       '(("he") ("n" "nn" "n'") ("ka" "ca") ("n" "nn" "n'"))
       (gen-hiragana->roman-pattens "へんかん"))
(test* "hiragana -> roman-pattern2"
       '(("ka" "ca") ("n" "nn" "n'") ("ji" "zi") ("he") ("n" "nn" "n'") ("ka" "ca") ("n" "nn" "n'"))
       (gen-hiragana->roman-pattens "かんじへんかん"))
(test* "hiragana -> roman-pattern3"
       '(("shi" "si") ("ze") ("n" "nn" "n'") ("ge") ("n" "nn" "n'") ("go") ("sho" "syo") ("ri"))
       (gen-hiragana->roman-pattens "しぜんげんごしょり"))

(test* "patterns -> roman-list1"
       '("kanji" "kanzi" "kannji" "kannzi" "kan'ji" "kan'zi" "canji" "canzi" "cannji" "cannzi" "can'ji" "can'zi")
       (patterns->roman-list  '(("ka" "ca") ("n" "nn" "n'") ("ji" "zi"))))

(test* "patterns -> roman-list2"
       '("shizengengoshori" "shizengengosyori" "shizengenngoshori" "shizengenngosyori" "shizengen'goshori" "shizengen'gosyori" "shizenngengoshori" "shizenngengosyori" "shizenngenngoshori" "shizenngenngosyori" "shizenngen'goshori" "shizenngen'gosyori" "shizen'gengoshori" "shizen'gengosyori" "shizen'genngoshori" "shizen'genngosyori" "shizen'gen'goshori" "shizen'gen'gosyori" "sizengengoshori" "sizengengosyori" "sizengenngoshori" "sizengenngosyori" "sizengen'goshori" "sizengen'gosyori" "sizenngengoshori" "sizenngengosyori" "sizenngenngoshori" "sizenngenngosyori" "sizenngen'goshori" "sizenngen'gosyori" "sizen'gengoshori" "sizen'gengosyori" "sizen'genngoshori" "sizen'genngosyori" "sizen'gen'goshori" "sizen'gen'gosyori")
       (patterns->roman-list  '(("shi" "si") ("ze") ("n" "nn" "n'") ("ge") ("n" "nn" "n'") ("go") ("sho" "syo") ("ri"))))

(test* "hiragana -> roman-list1"
       '("kanji" "kanzi" "kannji" "kannzi" "kan'ji" "kan'zi" "canji" "canzi" "cannji" "cannzi" "can'ji" "can'zi")
       (gen-hiragana->roman-list "かんじ"))

(test* "hiragana -> roman-list2"
       '("nishiyama" "nisiyama")
       (gen-hiragana->roman-list "にしやま"))

(test* "hiragana -> roman-list3"
       '("toukyou")
       (gen-hiragana->roman-list "とうきょう"))

(test* "hiragana -> roman-list4"
       '("ko-hi-" "ko-hi^" "ko^hi-" "ko^hi^" "co-hi-" "co-hi^" "co^hi-" "co^hi^")       
       (gen-hiragana->roman-list "こーひー"))

(test* "hiragana -> roman-list4"
       '("tsumiki" "tsumici" "tumiki" "tumici")
       (gen-hiragana->roman-list "つみき"))



;;===================================================================
(test-end)
