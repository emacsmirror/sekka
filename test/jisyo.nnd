;;-*- mode: nendo; syntax: scheme -*-;;
;; test for sekka jisyo library

(use nendo.test)
(load "./lib/convert-jisyo.nnd")

(define debug-print-length 2000)

(test-start "jisyo converter")

;;===================================================================

;;-------------------------------------------------------------------
(test-section "SKK2Sekka Convert")

(test* "expanding SKK(1) entry to SEKKA(n) entry. (送りなし1)"
       '(("ai" . "Cあい") ("あい" . "/愛/哀/相/挨/"))
       (expand-okuri-nashi-entry "あい" "/愛/哀/相/挨/"))
(test* "expanding SKK(1) entry to SEKKA(n) entry. (送りなし2)"
       '(("un" . "Cうん") ("うん" . "/云/運/雲/"))
       (expand-okuri-nashi-entry "うん" "/云/運/雲/"))
       
(test* "expanding SKK(1) entry to SEKKA(n) entry. (送りあり1)"
       '(("shiroI" . "Cしろi") ("siroI" . "Cしろi") ("しろi" . "/白/"))
       (expand-okuri-ari-entry   "しろ" "i" "/白/"))
(test* "expanding SKK(1) entry to SEKKA(n) entry. (送りあり2)"
       '(("kaK" . "Cかk") ("caK" . "Cかk") ("かk" . "/書/掛/欠/架/駆/懸/"))
       (expand-okuri-ari-entry   "か" "k" "/書/掛/欠/架/駆/懸/"))

(let1 _input (StringIO.new
              (string-join
               '(
                 ";; コメント"
                 ";; コメント コメント コメント コメント コメント "
                 "しろi /白/"
                 "あい /愛/哀/相/挨/"
                 "Greek /Α/Β/Γ/Δ/Ε/Ζ/Η/Θ/Ι/Κ/Λ/Μ/Ν/Ξ/Ο/Π/Ρ/Σ/Τ/Υ/Φ/Χ/Ψ/Ω/"
                 ">あん /案/"
                 ">やすi /易/"
                 )
               "\n"))
  (test* "convert SKK file to SEKKA jisyo file. (1)"
         '("shiroI Cしろi" "siroI Cしろi" "しろi /白/" "ai Cあい" "あい /愛/哀/相/挨/" "Greek /Α/Β/Γ/Δ/Ε/Ζ/Η/Θ/Ι/Κ/Λ/Μ/Ν/Ξ/Ο/Π/Ρ/Σ/Τ/Υ/Φ/Χ/Ψ/Ω/" ">an C>あん" ">あん /案/" ">yasuI C>やすi" ">やすi /易/")
         (convert-skk-jisyo-f _input)))


;;===================================================================
(test-end)
