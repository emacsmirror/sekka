;;-*- mode: nendo; syntax: scheme -*-;;
;; test for sekka jisyo library

(use nendo.test)
(load "./lib/roman-lib.nnd")

(define debug-print-length 2000)

(test-start "roman-lib")

;;===================================================================

;;-------------------------------------------------------------------
(test-section "kana->roman conversion hash")

(test* "kana->roman 1"
       '("fu" "hu")
       (hash-table-get sekka-kana->roman-hash "ふ" #f))
(test* "kana->roman 2"
       '("xa" "la")
       (hash-table-get sekka-kana->roman-hash "ぁ" #f))
(test* "kana->roman 3"
       '("chi" "ti" "tyi")
       (hash-table-get sekka-kana->roman-hash "ち" #f))
(test* "kana->roman 4"
       '("chi" "ti" "tyi")
       (hash-table-get sekka-kana->roman-hash "ち" #f))
(test* "kana->roman 5"
       '("-" "^")
       (hash-table-get sekka-kana->roman-hash "ー" #f))

;;-------------------------------------------------------------------
(test-section "roman->kana conversion hash")

(test* "roman->kana 1"
       '("あ")
       (hash-table-get sekka-roman->kana-hash "a" #f))
(test* "roman->kana 2"
       '("っぎゃ")
       (hash-table-get sekka-roman->kana-hash "ggya" #f))
(test* "roman->kana 3"
       '("し")
       (hash-table-get sekka-roman->kana-hash "si" #f))
(test* "roman->kana 4"
       '("っ")
       (hash-table-get sekka-roman->kana-hash "xtsu" #f))
(test* "roman->kana 5"
       '("ー")
       (hash-table-get sekka-roman->kana-hash "-" #f))


;;-------------------------------------------------------------------
(test-section "hiragana<->katanaka conversion functions")

(test* "hiragana->katakana 1"
       "アイウエオーァィゥェォッ"
       (gen-hiragana->katakana "あいうえおーぁぃぅぇぉっ"))
(test* "hiragana->katakana 2"
       "パイナップル"
       (gen-hiragana->katakana "ぱいなっぷる"))
(test* "hiragana->katakana 3"
       "アメニモマケズ"
       (gen-hiragana->katakana "あめにもまけず"))

(test* "hiragana->katakana 1"
       "あいうえおーぁぃぅぇぉっ"
       (gen-katakana->hiragana "アイウエオーァィゥェォッ"))
(test* "hiragana->katakana 2"
       "ありがとうございます"
       (gen-katakana->hiragana "アリガトウゴザイマス"))
(test* "hiragana->katakana 3"
       "いろはにほへとちりぬるを"
       (gen-katakana->hiragana "イロハニホヘトチリヌルヲ"))

(test* "is katakana 1"
       #t
       (is-katakana "アメニモマケズ"))
(test* "is katakana 2"
       #f
       (is-katakana "englishア"))
(test* "is katakana 3"
       #f
       (is-katakana "アenglish"))
(test* "is katakana 4"
       #f
       (is-katakana "engアlish"))
(test* "is katakana 5"
       #f
       (is-katakana "あア"))
(test* "is katakana 6"
       #f
       (is-katakana "アメニEモマケズ"))
(test* "is katakana 7"
       #t
       (is-katakana "コーヒー"))
(test* "is hiragana 1"
       #t
       (is-hiragana "ひらがなのぶんしょう"))
(test* "is hiragana 2"
       #f
       (is-hiragana "ひらがなノぶんしょう"))
(test* "is hiragana 3"
       #f
       (is-hiragana "Eひらがなのぶんしょう"))
(test* "is hiragana 4"
       #f
       (is-hiragana "ひらがなEのぶんしょう"))
(test* "is hiragana 5"
       #f
       (is-hiragana "ひらがなのぶんしょうE"))
(test* "is hiragana 6"
       #f
       (is-hiragana "あア"))
(test* "is hiragana 7"
       #t
       (is-hiragana "こーひー"))


;;-------------------------------------------------------------------
(test-section "kana->roman conversion functions")

(let1 hira-list
    (hash-table-keys sekka-kana->roman-hash)
  (test* "kana->roman table length"        233 (length hira-list))
  (test* "kana->roman key duplicate check" 233 (length (uniq (sort hira-list)))))

(test* "hiragana -> roman-pattern1"
       '(("he") ("n") ("ka" "ca") ("n"))
       (gen-hiragana->roman-pattens "へんかん"))
(test* "hiragana -> roman-pattern2"
       '(("ka" "ca") ("n") ("ji" "zi") ("he") ("n") ("ka" "ca") ("n"))
       (gen-hiragana->roman-pattens "かんじへんかん"))
(test* "hiragana -> roman-pattern3"
       '(("shi" "si") ("ze") ("n") ("ge") ("n") ("go") ("sho" "syo") ("ri"))
       (gen-hiragana->roman-pattens "しぜんげんごしょり"))

(test* "patterns -> roman-list1"
       '("kanji" "kanzi" "canji" "canzi")
       (patterns->roman-list  '(("ka" "ca") ("n") ("ji" "zi"))))

(test* "patterns -> roman-list2"
       '("shizengengoshori" "shizengengosyori" "sizengengoshori" "sizengengosyori")
       (patterns->roman-list  '(("shi" "si") ("ze") ("n") ("ge") ("n") ("go") ("sho" "syo") ("ri"))))

(test* "hiragana -> roman-list1"
       '("kanji" "kanzi" "canji" "canzi")
       (gen-hiragana->roman-list "かんじ"))

(test* "hiragana -> roman-list2"
       '("nishiyama" "nisiyama")
       (gen-hiragana->roman-list "にしやま"))

(test* "hiragana -> roman-list3"
       '("toukyou")
       (gen-hiragana->roman-list "とうきょう"))

(test* "hiragana -> roman-list4"
       '("ko-hi-" "ko-hi^" "ko^hi-" "ko^hi^" "co-hi-" "co-hi^" "co^hi-" "co^hi^")       
       (gen-hiragana->roman-list "こーひー"))

(test* "hiragana -> roman-list4"
       '("tsumiki" "tsumici" "tumiki" "tumici")
       (gen-hiragana->roman-list "つみき"))


;;-------------------------------------------------------------------
(test-section "roman->kana conversion functions")
(test* "roman -> hiragana 1"
       "つみき"       
       (gen-roman->hiragana "tsumiki"))
(test* "roman -> hiragana 2"
       "こーひー"
       (gen-roman->hiragana "ko-hi-"))
(test* "roman -> hiragana 3"
       "かんじ"
       (gen-roman->hiragana "kanji"))
(test* "roman -> hiragana 4"
       "かんじ"
       (gen-roman->hiragana "canzi"))
(test* "roman -> hiragana 5"
       "とうきょうとっきょきょかきょく"
       (gen-roman->hiragana "toukyoutokkyokyokakyoku"))
(test* "roman -> hiragana 6"
       "はっぴょうってきょうかぁ"
       (gen-roman->hiragana "happyouttekyoukaxa"))
(test* "roman -> hiragana 7"
       #f
       (gen-roman->hiragana "b"))
(test* "roman -> hiragana 8"
       #f
       (gen-roman->hiragana "xx"))


;;===================================================================
(test-end)
