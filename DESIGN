

                          Sekka(石火) DESIGN MEMO


Sekkaはモードレスなローマ字かな漢字変換エンジンです。SKKにインスパイアされています。

1. 特徴

  1) Emacsの上で動き、次のようなインタフェースを持ちます。
     日本語変換モードというものはありません。(Emacsのマイナーモードで作成)
     いつでも[Ctrl-J]キーで、カーソルキーの直前のローマ字が変換可能です。
     例えば、Nihongo[Ctrl-J] で 「日本語」に変換します。

  2) SKKの大文字小文字指定ルールが適用されます。
     OkonaU => 行う            に変換される。(送り仮名あり)
     okonaU => 行う            アルファベット中に大文字が1文字でもあれば漢字かな混じりとみなされる。
     okonau => おこなう        (全て平仮名)に変換される。
     Kanji  => 漢字,幹事       など、送り仮名なしの漢字に変換される

  3) ローマ字綴りミスはあいまい検索により、適度に救済されます。
     (Jaro-Winkler文字列類似度による検索)

  4) ローマ字の表記ゆれに標準で対応する。(通常ローマ字、ヘボン式などモード切替なしですべて対応可能)


2. 辞書ファイルの構造 (Keyがutf-8コード順にソートされるKVSを使う)

  1) アルファベットをキーとしたデータ

          << key部 >>   << value部 >>

ルール    [a-z]+        C で始まる。 (継続を表す) 複数の継続候補があれば、'/'で複数文字列を区切る
例         henkan       Cへんかん
例         hennkan      Cへんかん
例         henkann      Cへんかん
例         hennkann     Cへんかん
例         kani         Cかに/かんい
例         kanni        Cかに/かんい

ルール    [a-z]+[A-Z]   C で始まる   (継続を表す)
例         okoNau       Cおこn      ... 送り仮名付きの例

  2) キーに対して変換候補を保持するデータ

           << key部 >>  << value部 >>

ルール      任意     変換候補リスト   a/b/c/d/eのように '/'で候補を区切る。最後の '/' はあっても無視される
例         change        /チェンジ    ;;英語 => 日本語
例         へんかん      /変換/返還   ;;ひらがな => 漢字
例         へんかんs     /変換/返還   ;;ひらがな+送り仮名開始文字 => 送り仮名付き漢字かな混じり文節
例         !             /！/感嘆符   ;;記号 => 漢字や記号など


  3) その他
   - SKKの辞書をSekkaの辞書に変換するツールで上記データベースのimport用データ(プレインテキスト)を作る。
   - Sekkaの辞書をロード時に上記の全エントリを作成する。
   - 変換用DBの構築時に辞書中に重複する key が出現した場合は、value部に変換候補を足し込む。


4. コマンド
  1) 辞書メンテナンスツール
     - sekka-jisyo convert    SKK-JISYO.L を読み込み、SEKKA-JISYO.L などを生成する
     - sekka-jisyo load       SEKKA-JISYO.L を読み込みマスター辞書とする
     - sekka-jisyo merge      SEKKA-JISYO.L や SEKKA-JISYO.U(ユーザ辞書) を現在のマスター辞書にマージする
     - sekka-jisyo learn      コーパス(テキストファイル)を読み込み、マスター辞書の変換候補表示順を単語の出現順序にする。

  2) 変換エンジン
     - sekka-engine           エンジンを起動する。ネットワーク経由で変換を受け付ける。


5. ユーザー辞書の扱い
  master辞書とユーザー個別辞書は同一のKVSの中に混在しており、ネームスペースによって分離される。
  辞書からの単語探索順序は、master辞書→ユーザー個別辞書の順となる。
  ユーザー個別辞書は、master辞書との差分であり、先にユーザー個別辞書が探索され、もし見つからなければmaster辞書を探索する。

  1) ユーザー辞書の保存方法
     i) マスター辞書(全ユーザー共通)
        [key]                   [value]
       "MASTER::henkan"         "Cへんかん"
       "MASTER::へんかん"       "/変換/返還"

     i) ユーザー学習辞書(ユーザーの変換確定手順によって、マスター辞書と変換候補順が変化した場合)
       (user名がuuuuの場合)
        [key]                   [value]
       "uuuu::へんかん"         "/返還/変換"

  2) ユーザー登録語彙
     以下のエントリが追加される。
       (user名がuuuuの場合)
        [key]                                     [value]
     "uuuu::nihongonyuuryokumesoddo"              "Cにほんごにゅうりょくめそっど"
     "uuuu::にほんごにゅうりょくめそっど"         "/日本語入力メソッド"

  3) インデックス
     例えば、上記の日本語入力メソッドという単語エントリが追加された場合、
     niから始まる語彙のインデックスも更新され、下記のようになる。
       (user名がuuuuの場合)
      [key]               [value]
     "master:(ni)"        ni ni-  nihongo nihongoca nihongoka nihongonyuuryocu  niwa niwatori nizi 
     "uuuu:(ni)"          ni ni-  nihongo nihongonyuuryokumesoddo nihongoca nihongoka nihongonyuuryocu  niwa niwatori nizi 



[EOF]
